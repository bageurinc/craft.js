{"version":3,"file":"RenderLayerIndicator.js","sourceRoot":"","sources":["../../src/events/RenderLayerIndicator.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useEditor } from '@craftjs/core';\nimport React, { useMemo } from 'react';\nimport { styled, keyframes } from 'styled-components';\n\nimport { useLayerManager } from '../manager/useLayerManager';\n\nconst pulse = keyframes`\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.7;\n  }\n`;\n\nconst StyledIndicator = styled.div<{ $error?: boolean }>`\n  position: fixed;\n  pointer-events: none;\n  z-index: 99999;\n  box-shadow: ${(props) =>\n    props.$error\n      ? '0 0 8px rgba(239, 68, 68, 0.6)'\n      : '0 0 8px rgba(59, 130, 246, 0.6)'};\n  animation: ${pulse} 1.5s ease-in-out infinite;\n`;\n\ntype RenderLayerIndicatorProps = {\n  children?: React.ReactNode;\n};\n\nexport const RenderLayerIndicator = ({\n  children,\n}: RenderLayerIndicatorProps) => {\n  const { layers, events } = useLayerManager((state) => state);\n  const { query } = useEditor((state) => ({ enabled: state.options.enabled }));\n  const { indicator: indicatorStyles } = query.getOptions();\n\n  const indicatorPosition = useMemo(() => {\n    const { indicator } = events;\n\n    if (indicator) {\n      const {\n        placement: { where, parent, currentNode },\n        error,\n      } = indicator;\n      const layerId = currentNode ? currentNode.id : parent.id;\n\n      let top;\n      const color = error ? indicatorStyles.error : indicatorStyles.success;\n\n      if (indicator.onCanvas && layers[parent.id].dom != null) {\n        const parentPos = layers[parent.id].dom.getBoundingClientRect();\n        const parentHeadingPos = layers[\n          parent.id\n        ].headingDom.getBoundingClientRect();\n        return {\n          top: parentHeadingPos.top,\n          left: parentPos.left,\n          width: parentPos.width,\n          height: parentHeadingPos.height,\n          background: 'transparent',\n          borderWidth: '1px',\n          borderColor: color,\n        };\n      } else {\n        if (!layers[layerId]) return;\n        const headingPos = layers[layerId].headingDom.getBoundingClientRect();\n        const pos = layers[layerId].dom.getBoundingClientRect();\n\n        if (where === 'after' || !currentNode) {\n          top = pos.top + pos.height;\n        } else {\n          top = pos.top;\n        }\n\n        return {\n          top,\n          left: headingPos.left,\n          width: pos.width + pos.left - headingPos.left,\n          height: 4,\n          borderWidth: 0,\n          background: color,\n        };\n      }\n    }\n  }, [events, indicatorStyles.error, indicatorStyles.success, layers]);\n\n  return (\n    <div>\n      {events.indicator ? (\n        <StyledIndicator\n          $error={!!events.indicator.error}\n          style={indicatorPosition}\n        />\n      ) : null}\n      {children}\n    </div>\n  );\n};\n"]}