{"version":3,"file":"index.js","sources":["../../src/constants.ts","../../src/History.ts","../../src/useMethods.ts","../../src/getDOMInfo.ts","../../src/useCollector.tsx","../../src/getRandomId.ts","../../src/EventHandlers/ConnectorRegistry.ts","../../src/EventHandlers/interfaces.ts","../../src/EventHandlers/isEventBlockedByDescendant.ts","../../src/EventHandlers/EventHandlers.ts","../../src/EventHandlers/DerivedEventHandlers.ts","../../src/EventHandlers/wrapConnectorHooks.tsx","../../src/RenderIndicator.tsx","../../src/useEffectOnce.tsx","../../src/deprecate.ts","../../src/platform.ts"],"sourcesContent":["export const ROOT_NODE = 'ROOT';\nexport const DEPRECATED_ROOT_NODE = 'canvas-ROOT';\n\n// TODO: Use a better way to store/display error messages\nexport const ERROR_NOPARENT = 'Parent id cannot be ommited';\nexport const ERROR_DUPLICATE_NODEID =\n  'Attempting to add a node with duplicated id';\nexport const ERROR_INVALID_NODEID =\n  'Node does not exist, it may have been removed';\nexport const ERROR_TOP_LEVEL_ELEMENT_NO_ID =\n  'A <Element /> that is used inside a User Component must specify an `id` prop, eg: <Element id=\"text_element\">...</Element> ';\nexport const ERROR_MISSING_PLACEHOLDER_PLACEMENT =\n  'Placeholder required placement info (parent, index, or where) is missing';\nexport const ERROR_MOVE_CANNOT_DROP =\n  'Node cannot be dropped into target parent';\nexport const ERROR_MOVE_INCOMING_PARENT = 'Target parent rejects incoming node';\nexport const ERROR_MOVE_OUTGOING_PARENT =\n  'Current parent rejects outgoing node';\nexport const ERROR_MOVE_NONCANVAS_CHILD =\n  'Cannot move node that is not a direct child of a Canvas node';\nexport const ERROR_MOVE_TO_NONCANVAS_PARENT =\n  'Cannot move node into a non-Canvas parent';\nexport const ERROR_MOVE_TOP_LEVEL_NODE = 'A top-level Node cannot be moved';\nexport const ERROR_MOVE_ROOT_NODE = 'Root Node cannot be moved';\n\nexport const ERROR_MOVE_TO_DESCENDANT = 'Cannot move node into a descendant';\nexport const ERROR_NOT_IN_RESOLVER =\n  'The component type specified for this node (%node_type%) does not exist in the resolver';\nexport const ERROR_INFINITE_CANVAS =\n  \"The component specified in the <Canvas> `is` prop has additional Canvas specified in it's render template.\";\nexport const ERROR_CANNOT_DRAG =\n  'The node has specified a canDrag() rule that prevents it from being dragged';\nexport const ERROR_INVALID_NODE_ID = 'Invalid parameter Node Id specified';\nexport const ERROR_DELETE_TOP_LEVEL_NODE =\n  'Attempting to delete a top-level Node';\n\nexport const ERROR_RESOLVER_NOT_AN_OBJECT = `Resolver in <Editor /> has to be an object. For (de)serialization Craft.js needs a list of all the User Components. \n    \nMore info: https://craft.js.org/r/docs/api/editor#props`;\n\nexport const ERROR_DESERIALIZE_COMPONENT_NOT_IN_RESOLVER = `An Error occurred while deserializing components: Cannot find component <%displayName% /> in resolver map. Please check your resolver in <Editor />\n\nAvailable components in resolver: %availableComponents%\n\nMore info: https://craft.js.org/r/docs/api/editor#props`;\n\nexport const ERROR_USE_EDITOR_OUTSIDE_OF_EDITOR_CONTEXT = `You can only use useEditor in the context of <Editor />. \n\nPlease only use useEditor in components that are children of the <Editor /> component.`;\n\nexport const ERROR_USE_NODE_OUTSIDE_OF_EDITOR_CONTEXT = `You can only use useNode in the context of <Editor />. \n\nPlease only use useNode in components that are children of the <Editor /> component.`;\n","import { Patch, applyPatches } from 'immer';\n\ntype Timeline = Array<{\n  patches: Patch[];\n  inversePatches: Patch[];\n  timestamp: number;\n}>;\n\nexport const HISTORY_ACTIONS = {\n  UNDO: 'HISTORY_UNDO',\n  REDO: 'HISTORY_REDO',\n  THROTTLE: 'HISTORY_THROTTLE',\n  IGNORE: 'HISTORY_IGNORE',\n  MERGE: 'HISTORY_MERGE',\n  CLEAR: 'HISTORY_CLEAR',\n};\n\nexport class History {\n  timeline: Timeline = [];\n  pointer = -1;\n\n  add(patches: Patch[], inversePatches: Patch[]) {\n    if (patches.length === 0 && inversePatches.length === 0) {\n      return;\n    }\n\n    this.pointer = this.pointer + 1;\n    this.timeline.length = this.pointer;\n    this.timeline[this.pointer] = {\n      patches,\n      inversePatches,\n      timestamp: Date.now(),\n    };\n  }\n\n  throttleAdd(\n    patches: Patch[],\n    inversePatches: Patch[],\n    throttleRate: number = 500\n  ) {\n    if (patches.length === 0 && inversePatches.length === 0) {\n      return;\n    }\n\n    if (this.timeline.length && this.pointer >= 0) {\n      const {\n        patches: currPatches,\n        inversePatches: currInversePatches,\n        timestamp,\n      } = this.timeline[this.pointer];\n\n      const now = new Date();\n      const diff = now.getTime() - timestamp;\n\n      if (diff < throttleRate) {\n        this.timeline[this.pointer] = {\n          timestamp,\n          patches: [...currPatches, ...patches],\n          inversePatches: [...inversePatches, ...currInversePatches],\n        };\n        return;\n      }\n    }\n\n    this.add(patches, inversePatches);\n  }\n\n  merge(patches: Patch[], inversePatches: Patch[]) {\n    if (patches.length === 0 && inversePatches.length === 0) {\n      return;\n    }\n\n    if (this.timeline.length && this.pointer >= 0) {\n      const {\n        patches: currPatches,\n        inversePatches: currInversePatches,\n        timestamp,\n      } = this.timeline[this.pointer];\n\n      this.timeline[this.pointer] = {\n        timestamp,\n        patches: [...currPatches, ...patches],\n        inversePatches: [...inversePatches, ...currInversePatches],\n      };\n      return;\n    }\n\n    this.add(patches, inversePatches);\n  }\n\n  clear() {\n    this.timeline = [];\n    this.pointer = -1;\n  }\n\n  canUndo() {\n    return this.pointer >= 0;\n  }\n\n  canRedo() {\n    return this.pointer < this.timeline.length - 1;\n  }\n\n  undo(state) {\n    if (!this.canUndo()) {\n      return;\n    }\n\n    const { inversePatches } = this.timeline[this.pointer];\n    this.pointer = this.pointer - 1;\n    return applyPatches(state, inversePatches);\n  }\n\n  redo(state) {\n    if (!this.canRedo()) {\n      return;\n    }\n\n    this.pointer = this.pointer + 1;\n    const { patches } = this.timeline[this.pointer];\n    return applyPatches(state, patches);\n  }\n}\n","// https://github.com/pelotom/use-methods\nimport produce, {\n  Patch,\n  produceWithPatches,\n  enableMapSet,\n  enablePatches,\n} from 'immer';\nimport isEqualWith from 'lodash/isEqualWith';\nimport { useMemo, useEffect, useRef, useCallback } from 'react';\n\nimport { History, HISTORY_ACTIONS } from './History';\nimport { Delete } from './utilityTypes';\n\nenableMapSet();\nenablePatches();\n\nexport type SubscriberAndCallbacksFor<\n  M extends MethodsOrOptions,\n  Q extends QueryMethods = any\n> = {\n  subscribe: Watcher<StateFor<M>>['subscribe'];\n  getState: () => { prev: StateFor<M>; current: StateFor<M> };\n  actions: CallbacksFor<M>;\n  query: QueryCallbacksFor<Q>;\n  history: History;\n};\n\nexport type StateFor<M extends MethodsOrOptions> = M extends MethodsOrOptions<\n  infer S,\n  any\n>\n  ? S\n  : never;\n\nexport type CallbacksFor<\n  M extends MethodsOrOptions\n> = M extends MethodsOrOptions<any, infer R>\n  ? {\n      [T in ActionUnion<R>['type']]: (\n        ...payload: ActionByType<ActionUnion<R>, T>['payload']\n      ) => void;\n    } & {\n      history: {\n        undo: () => void;\n        redo: () => void;\n        clear: () => void;\n        throttle: (\n          rate?: number\n        ) => Delete<\n          {\n            [T in ActionUnion<R>['type']]: (\n              ...payload: ActionByType<ActionUnion<R>, T>['payload']\n            ) => void;\n          },\n          M extends Options ? M['ignoreHistoryForActions'][number] : never\n        >;\n        merge: () => Delete<\n          {\n            [T in ActionUnion<R>['type']]: (\n              ...payload: ActionByType<ActionUnion<R>, T>['payload']\n            ) => void;\n          },\n          M extends Options ? M['ignoreHistoryForActions'][number] : never\n        >;\n        ignore: () => Delete<\n          {\n            [T in ActionUnion<R>['type']]: (\n              ...payload: ActionByType<ActionUnion<R>, T>['payload']\n            ) => void;\n          },\n          M extends Options ? M['ignoreHistoryForActions'][number] : never\n        >;\n      };\n    }\n  : {};\n\nexport type Methods<S = any, R extends MethodRecordBase<S> = any, Q = any> = (\n  state: S,\n  query: Q\n) => R;\n\nexport type Options<S = any, R extends MethodRecordBase<S> = any, Q = any> = {\n  methods: Methods<S, R, Q>;\n  ignoreHistoryForActions: ReadonlyArray<keyof MethodRecordBase>;\n  normalizeHistory?: (state: S) => void;\n};\n\nexport type MethodsOrOptions<\n  S = any,\n  R extends MethodRecordBase<S> = any,\n  Q = any\n> = Methods<S, R, Q> | Options<S, R, Q>;\n\nexport type MethodRecordBase<S = any> = Record<\n  string,\n  (...args: any[]) => S extends object ? S | void : S\n>;\n\nexport type Action<T = any, P = any> = {\n  type: T;\n  payload?: P;\n  config?: Record<string, any>;\n};\n\nexport type ActionUnion<R extends MethodRecordBase> = {\n  [T in keyof R]: { type: T; payload: Parameters<R[T]> };\n}[keyof R];\n\nexport type ActionByType<A, T> = A extends { type: infer T2 }\n  ? T extends T2\n    ? A\n    : never\n  : never;\n\nexport type QueryMethods<\n  S = any,\n  O = any,\n  R extends MethodRecordBase<S> = any\n> = (state?: S, options?: O) => R;\nexport type QueryCallbacksFor<M extends QueryMethods> = M extends QueryMethods<\n  any,\n  any,\n  infer R\n>\n  ? {\n      [T in ActionUnion<R>['type']]: (\n        ...payload: ActionByType<ActionUnion<R>, T>['payload']\n      ) => ReturnType<R[T]>;\n    } & {\n      history: {\n        canUndo: () => boolean;\n        canRedo: () => boolean;\n      };\n    }\n  : {};\n\nexport type PatchListenerAction<M extends MethodsOrOptions> = {\n  type: keyof CallbacksFor<M>;\n  params: any;\n  patches: Patch[];\n};\n\nexport type PatchListener<\n  S,\n  M extends MethodsOrOptions,\n  Q extends QueryMethods\n> = (\n  newState: S,\n  previousState: S,\n  actionPerformedWithPatches: PatchListenerAction<M>,\n  query: QueryCallbacksFor<Q>,\n  normalizer: (cb: (draft: S) => void) => void\n) => void;\n\nexport function useMethods<S, R extends MethodRecordBase<S>>(\n  methodsOrOptions: MethodsOrOptions<S, R>, // methods to manipulate the state\n  initialState: any\n): SubscriberAndCallbacksFor<MethodsOrOptions<S, R>>;\n\nexport function useMethods<\n  S,\n  R extends MethodRecordBase<S>,\n  Q extends QueryMethods\n>(\n  methodsOrOptions: MethodsOrOptions<S, R, QueryCallbacksFor<Q>>, // methods to manipulate the state\n  initialState: any,\n  queryMethods: Q\n): SubscriberAndCallbacksFor<MethodsOrOptions<S, R>, Q>;\n\nexport function useMethods<\n  S,\n  R extends MethodRecordBase<S>,\n  Q extends QueryMethods\n>(\n  methodsOrOptions: MethodsOrOptions<S, R, QueryCallbacksFor<Q>>, // methods to manipulate the state\n  initialState: any,\n  queryMethods: Q,\n  patchListener: PatchListener<\n    S,\n    MethodsOrOptions<S, R, QueryCallbacksFor<Q>>,\n    Q\n  >\n): SubscriberAndCallbacksFor<MethodsOrOptions<S, R>, Q>;\n\nexport function useMethods<\n  S,\n  R extends MethodRecordBase<S>,\n  Q extends QueryMethods = null\n>(\n  methodsOrOptions: MethodsOrOptions<S, R>,\n  initialState: any,\n  queryMethods?: Q,\n  patchListener?: any\n): SubscriberAndCallbacksFor<MethodsOrOptions<S, R>, Q> {\n  const history = useMemo(() => new History(), []);\n\n  let methodsFactory: Methods<S, R>;\n  let ignoreHistoryForActionsRef = useRef([]);\n  let normalizeHistoryRef = useRef<any>(() => {});\n\n  if (typeof methodsOrOptions === 'function') {\n    methodsFactory = methodsOrOptions;\n  } else {\n    methodsFactory = methodsOrOptions.methods;\n    ignoreHistoryForActionsRef.current = methodsOrOptions.ignoreHistoryForActions as any;\n    normalizeHistoryRef.current = methodsOrOptions.normalizeHistory;\n  }\n\n  const patchListenerRef = useRef(patchListener);\n  patchListenerRef.current = patchListener;\n\n  const stateRef = useRef(initialState);\n\n  const reducer = useMemo(() => {\n    const { current: normalizeHistory } = normalizeHistoryRef;\n    const { current: ignoreHistoryForActions } = ignoreHistoryForActionsRef;\n    const { current: patchListener } = patchListenerRef;\n\n    return (state: S, action: Action) => {\n      const query =\n        queryMethods && createQuery(queryMethods, () => state, history);\n\n      let finalState;\n      let [nextState, patches, inversePatches] = (produceWithPatches as any)(\n        state,\n        (draft: S) => {\n          switch (action.type) {\n            case HISTORY_ACTIONS.UNDO: {\n              return history.undo(draft);\n            }\n            case HISTORY_ACTIONS.REDO: {\n              return history.redo(draft);\n            }\n            case HISTORY_ACTIONS.CLEAR: {\n              history.clear();\n              return {\n                ...draft,\n              };\n            }\n\n            // TODO: Simplify History API\n            case HISTORY_ACTIONS.IGNORE:\n            case HISTORY_ACTIONS.MERGE:\n            case HISTORY_ACTIONS.THROTTLE: {\n              const [type, ...params] = action.payload;\n              methodsFactory(draft, query)[type](...params);\n              break;\n            }\n            default:\n              methodsFactory(draft, query)[action.type](...action.payload);\n          }\n        }\n      );\n\n      finalState = nextState;\n\n      if (patchListener) {\n        patchListener(\n          nextState,\n          state,\n          { type: action.type, params: action.payload, patches },\n          query,\n          (cb) => {\n            let normalizedDraft = produceWithPatches(nextState, cb);\n            finalState = normalizedDraft[0];\n\n            patches = [...patches, ...normalizedDraft[1]];\n            inversePatches = [...normalizedDraft[2], ...inversePatches];\n          }\n        );\n      }\n\n      if (\n        [HISTORY_ACTIONS.UNDO, HISTORY_ACTIONS.REDO].includes(\n          action.type as any\n        ) &&\n        normalizeHistory\n      ) {\n        finalState = produce(finalState, normalizeHistory);\n      }\n\n      if (\n        ![\n          ...ignoreHistoryForActions,\n          HISTORY_ACTIONS.UNDO,\n          HISTORY_ACTIONS.REDO,\n          HISTORY_ACTIONS.IGNORE,\n          HISTORY_ACTIONS.CLEAR,\n        ].includes(action.type as any)\n      ) {\n        if (action.type === HISTORY_ACTIONS.THROTTLE) {\n          history.throttleAdd(\n            patches,\n            inversePatches,\n            action.config && action.config.rate\n          );\n        } else if (action.type === HISTORY_ACTIONS.MERGE) {\n          history.merge(patches, inversePatches);\n        } else {\n          history.add(patches, inversePatches);\n        }\n      }\n\n      return finalState;\n    };\n  }, [history, methodsFactory, queryMethods]);\n\n  const getState = useCallback(() => stateRef.current, []);\n  const watcher = useMemo(() => new Watcher<S>(getState), [getState]);\n\n  const dispatch = useCallback(\n    (action: any) => {\n      const newState = reducer(stateRef.current, action);\n      stateRef.current = newState;\n      watcher.notify();\n    },\n    [reducer, watcher]\n  );\n\n  useEffect(() => {\n    watcher.notify();\n  }, [watcher]);\n\n  const query = useMemo(\n    () =>\n      !queryMethods\n        ? []\n        : createQuery(queryMethods, () => stateRef.current, history),\n    [history, queryMethods]\n  );\n\n  const actions = useMemo(() => {\n    const actionTypes = Object.keys(methodsFactory(null, null));\n\n    const { current: ignoreHistoryForActions } = ignoreHistoryForActionsRef;\n\n    return {\n      ...actionTypes.reduce((accum, type) => {\n        accum[type] = (...payload) => dispatch({ type, payload });\n        return accum;\n      }, {} as any),\n      history: {\n        undo() {\n          return dispatch({\n            type: HISTORY_ACTIONS.UNDO,\n          });\n        },\n        redo() {\n          return dispatch({\n            type: HISTORY_ACTIONS.REDO,\n          });\n        },\n        clear: () => {\n          return dispatch({\n            type: HISTORY_ACTIONS.CLEAR,\n          });\n        },\n        throttle: (rate) => {\n          return {\n            ...actionTypes\n              .filter((type) => !ignoreHistoryForActions.includes(type))\n              .reduce((accum, type) => {\n                accum[type] = (...payload) =>\n                  dispatch({\n                    type: HISTORY_ACTIONS.THROTTLE,\n                    payload: [type, ...payload],\n                    config: {\n                      rate: rate,\n                    },\n                  });\n                return accum;\n              }, {} as any),\n          };\n        },\n        ignore: () => {\n          return {\n            ...actionTypes\n              .filter((type) => !ignoreHistoryForActions.includes(type))\n              .reduce((accum, type) => {\n                accum[type] = (...payload) =>\n                  dispatch({\n                    type: HISTORY_ACTIONS.IGNORE,\n                    payload: [type, ...payload],\n                  });\n                return accum;\n              }, {} as any),\n          };\n        },\n        merge: () => {\n          return {\n            ...actionTypes\n              .filter((type) => !ignoreHistoryForActions.includes(type))\n              .reduce((accum, type) => {\n                accum[type] = (...payload) =>\n                  dispatch({\n                    type: HISTORY_ACTIONS.MERGE,\n                    payload: [type, ...payload],\n                  });\n                return accum;\n              }, {} as any),\n          };\n        },\n      },\n    };\n  }, [dispatch, methodsFactory]);\n\n  return useMemo(\n    () => ({\n      getState,\n      subscribe: (collector, cb, collectOnCreate) =>\n        watcher.subscribe(collector, cb, collectOnCreate),\n      actions,\n      query,\n      history,\n    }),\n    [actions, query, watcher, getState, history]\n  ) as any;\n}\n\nexport function createQuery<Q extends QueryMethods>(\n  queryMethods: Q,\n  getState,\n  history: History\n) {\n  const queries = Object.keys(queryMethods()).reduce((accum, key) => {\n    return {\n      ...accum,\n      [key]: (...args: any) => {\n        return queryMethods(getState())[key](...args);\n      },\n    };\n  }, {} as QueryCallbacksFor<typeof queryMethods>);\n\n  return {\n    ...queries,\n    history: {\n      canUndo: () => history.canUndo(),\n      canRedo: () => history.canRedo(),\n    },\n  };\n}\n\nclass Watcher<S> {\n  getState;\n  subscribers: Subscriber[] = [];\n\n  constructor(getState) {\n    this.getState = getState;\n  }\n\n  /**\n   * Creates a Subscriber\n   * @returns {() => void} a Function that removes the Subscriber\n   */\n  subscribe<C>(\n    collector: (state: S) => C,\n    onChange: (collected: C) => void,\n    collectOnCreate?: boolean\n  ): () => void {\n    const subscriber = new Subscriber(\n      () => collector(this.getState()),\n      onChange,\n      collectOnCreate\n    );\n    this.subscribers.push(subscriber);\n    return this.unsubscribe.bind(this, subscriber);\n  }\n\n  unsubscribe(subscriber) {\n    if (this.subscribers.length) {\n      const index = this.subscribers.indexOf(subscriber);\n      if (index > -1) return this.subscribers.splice(index, 1);\n    }\n  }\n\n  notify() {\n    this.subscribers.forEach((subscriber) => subscriber.collect());\n  }\n}\n\nclass Subscriber {\n  collected: any;\n  collector: () => any;\n  onChange: (collected: any) => void;\n  id;\n\n  /**\n   * Creates a Subscriber\n   * @param collector The method that returns an object of values to be collected\n   * @param onChange A callback method that is triggered when the collected values has changed\n   * @param collectOnCreate If set to true, the collector/onChange will be called on instantiation\n   */\n  constructor(collector, onChange, collectOnCreate = false) {\n    this.collector = collector;\n    this.onChange = onChange;\n\n    // Collect and run onChange callback when Subscriber is created\n    if (collectOnCreate) this.collect();\n  }\n\n  collect() {\n    try {\n      const recollect = this.collector();\n      if (!isEqualWith(recollect, this.collected)) {\n        this.collected = recollect;\n        if (this.onChange) this.onChange(this.collected);\n      }\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn(err);\n    }\n  }\n}\n","export const getDOMInfo = (el: HTMLElement) => {\n  const {\n    x,\n    y,\n    top,\n    left,\n    bottom,\n    right,\n    width,\n    height,\n  } = el.getBoundingClientRect() as DOMRect;\n\n  const style = window.getComputedStyle(el);\n\n  const margin = {\n    left: parseInt(style.marginLeft),\n    right: parseInt(style.marginRight),\n    bottom: parseInt(style.marginBottom),\n    top: parseInt(style.marginTop),\n  };\n\n  const padding = {\n    left: parseInt(style.paddingLeft),\n    right: parseInt(style.paddingRight),\n    bottom: parseInt(style.paddingBottom),\n    top: parseInt(style.paddingTop),\n  };\n\n  const styleInFlow = (parent: HTMLElement) => {\n    const parentStyle: any = getComputedStyle(parent);\n\n    if (style.overflow && style.overflow !== 'visible') {\n      return;\n    }\n\n    if (parentStyle.float !== 'none') {\n      return;\n    }\n\n    if (parentStyle.display === 'grid') {\n      return;\n    }\n\n    if (\n      parentStyle.display === 'flex' &&\n      parentStyle['flex-direction'] !== 'column'\n    ) {\n      return;\n    }\n\n    switch (style.position) {\n      case 'static':\n      case 'relative':\n        break;\n      default:\n        return;\n    }\n\n    switch (el.tagName) {\n      case 'TR':\n      case 'TBODY':\n      case 'THEAD':\n      case 'TFOOT':\n        return true;\n    }\n\n    switch (style.display) {\n      case 'block':\n      case 'list-item':\n      case 'table':\n      case 'flex':\n      case 'grid':\n        return true;\n    }\n\n    return;\n  };\n\n  return {\n    x,\n    y,\n    top,\n    left,\n    bottom,\n    right,\n    width,\n    height,\n    outerWidth: Math.round(width + margin.left + margin.right),\n    outerHeight: Math.round(height + margin.top + margin.bottom),\n    margin,\n    padding,\n    inFlow: el.parentElement && !!styleInFlow(el.parentElement),\n  };\n};\n","import { useState, useCallback, useRef, useEffect } from 'react';\n\nimport { SubscriberAndCallbacksFor } from './useMethods';\nimport { ConditionallyMergeRecordTypes } from './utilityTypes';\n\ntype CollectorMethods<S extends SubscriberAndCallbacksFor<any, any>> = {\n  actions: S['actions'];\n  query: S['query'];\n};\n\nexport type useCollectorReturnType<\n  S extends SubscriberAndCallbacksFor<any, any>,\n  C = null\n> = ConditionallyMergeRecordTypes<C, CollectorMethods<S>>;\nexport function useCollector<S extends SubscriberAndCallbacksFor<any, any>, C>(\n  store: S,\n  collector?: (\n    state: ReturnType<S['getState']>['current'],\n    query: S['query']\n  ) => C\n): useCollectorReturnType<S, C> {\n  const { subscribe, getState, actions, query } = store;\n\n  const initial = useRef(true);\n  const collected = useRef<any>(null);\n  const collectorRef = useRef(collector);\n  collectorRef.current = collector;\n\n  const onCollect = useCallback(\n    (collected) => {\n      return { ...collected, actions, query };\n    },\n    [actions, query]\n  );\n\n  // Collect states for initial render\n  if (initial.current && collector) {\n    collected.current = collector(getState(), query);\n    initial.current = false;\n  }\n\n  const [renderCollected, setRenderCollected] = useState(\n    onCollect(collected.current)\n  );\n\n  // Collect states on state change\n  useEffect(() => {\n    let unsubscribe;\n    if (collectorRef.current) {\n      unsubscribe = subscribe(\n        (current) => collectorRef.current(current, query),\n        (collected) => {\n          setRenderCollected(onCollect(collected));\n        }\n      );\n    }\n    return () => {\n      if (unsubscribe) unsubscribe();\n    };\n  }, [onCollect, query, subscribe]);\n\n  return renderCollected;\n}\n","import { nanoid } from 'nanoid';\n\n// By default nanoid generate an ID with 21 characters. To reduce the footprint, we default to 10 characters.\n// We have a higher probability for collisions, though\n\n/**\n * Generate a random ID. That ID can for example be used as a node ID.\n *\n * @param size The number of characters that are generated for the ID. Defaults to `10`\n * @returns A random id\n */\nexport const getRandomId = (size: number = 10) => nanoid(size);\n","import isEqual from 'shallowequal';\n\nimport { ConnectorToRegister, RegisteredConnector } from './interfaces';\n\nimport { getRandomId } from '../getRandomId';\n\n/**\n * Stores all connected DOM elements and their connectors here\n * This allows us to easily enable/disable and perform cleanups\n */\nexport class ConnectorRegistry {\n  private isEnabled: boolean = true;\n\n  private elementIdMap: WeakMap<HTMLElement, string> = new WeakMap();\n  private registry: Map<String, RegisteredConnector> = new Map();\n\n  private getElementId(element: HTMLElement) {\n    const existingId = this.elementIdMap.get(element);\n    if (existingId) {\n      return existingId;\n    }\n\n    const newId = getRandomId();\n\n    this.elementIdMap.set(element, newId);\n    return newId;\n  }\n\n  getConnectorId(element: HTMLElement, connectorName: string) {\n    const elementId = this.getElementId(element);\n    return `${connectorName}--${elementId}`;\n  }\n\n  register(element: HTMLElement, connectorPayload: ConnectorToRegister) {\n    const existingConnector = this.getByElement(element, connectorPayload.name);\n\n    if (existingConnector) {\n      if (isEqual(connectorPayload.required, existingConnector.required)) {\n        return existingConnector;\n      }\n\n      this.getByElement(element, connectorPayload.name).disable();\n    }\n\n    let cleanup: () => void | null = null;\n\n    const id = this.getConnectorId(element, connectorPayload.name);\n    this.registry.set(id, {\n      id,\n      required: connectorPayload.required,\n      enable: () => {\n        if (cleanup) {\n          cleanup();\n        }\n\n        cleanup = connectorPayload.connector(\n          element,\n          connectorPayload.required,\n          connectorPayload.options\n        );\n      },\n      disable: () => {\n        if (!cleanup) {\n          return;\n        }\n\n        cleanup();\n      },\n      remove: () => {\n        return this.remove(id);\n      },\n    });\n\n    if (this.isEnabled) {\n      this.registry.get(id).enable();\n    }\n\n    return this.registry.get(id);\n  }\n\n  get(id: string) {\n    return this.registry.get(id);\n  }\n\n  remove(id: string) {\n    const connector = this.get(id);\n    if (!connector) {\n      return;\n    }\n\n    connector.disable();\n    this.registry.delete(connector.id);\n  }\n\n  enable() {\n    this.isEnabled = true;\n    this.registry.forEach((connectors) => {\n      connectors.enable();\n    });\n  }\n\n  disable() {\n    this.isEnabled = false;\n    this.registry.forEach((connectors) => {\n      connectors.disable();\n    });\n  }\n\n  getByElement(element: HTMLElement, connectorName: string) {\n    return this.get(this.getConnectorId(element, connectorName));\n  }\n\n  removeByElement(element: HTMLElement, connectorName: string) {\n    return this.remove(this.getConnectorId(element, connectorName));\n  }\n\n  clear() {\n    this.disable();\n    this.elementIdMap = new WeakMap();\n    this.registry = new Map();\n  }\n}\n","import { EventHandlers } from './EventHandlers';\n\nexport type Connector = (el: HTMLElement, ...args: any) => any;\n\nexport type ConnectorsRecord = Record<string, Connector>;\n\nexport type ChainableConnector<T extends Connector, O extends any> = T extends (\n  element: infer E,\n  ...args: infer P\n) => any\n  ? <B extends E | O>(element: B, ...args: P) => B\n  : never;\n\nexport type ChainableConnectors<\n  H extends ConnectorsRecord,\n  E extends any = HTMLElement\n> = {\n  [T in keyof H]: H[T] extends Connector ? ChainableConnector<H[T], E> : never;\n};\n\nexport type CraftDOMEvent<T extends Event> = T & {\n  craft: {\n    stopPropagation: () => void;\n    blockedEvents: Record<string, HTMLElement[]>;\n  };\n};\n\nexport type CraftEventListener<K extends keyof HTMLElementEventMap> = (\n  ev: CraftDOMEvent<HTMLElementEventMap[K]>\n) => any;\n\nexport type EventHandlerConnectors<\n  H extends EventHandlers,\n  E extends any = HTMLElement\n> = ChainableConnectors<ReturnType<H['handlers']>, E>;\n\nexport type ConnectorsUsage<H extends EventHandlers> = {\n  register: () => void;\n  cleanup: () => void;\n  connectors: EventHandlerConnectors<H>;\n};\n\nexport enum EventHandlerUpdates {\n  HandlerDisabled,\n  HandlerEnabled,\n}\n\nexport type ConnectorToRegister = {\n  name: string;\n  required: any;\n  connector: Connector;\n  options?: Record<string, any>;\n};\n\nexport type RegisteredConnector = {\n  id: string;\n  required: any;\n  enable: () => void;\n  disable: () => void;\n  remove: () => void;\n};\n","import { CraftDOMEvent } from './interfaces';\n\n/**\n * Check if a specified event is blocked by a child\n * that's a descendant of the specified element\n */\nexport function isEventBlockedByDescendant<K extends keyof HTMLElementEventMap>(\n  e: CraftDOMEvent<HTMLElementEventMap[K]>,\n  eventName: K,\n  el: HTMLElement\n) {\n  // Store initial Craft event value\n  if (!e.craft) {\n    e.craft = {\n      stopPropagation: () => {},\n      blockedEvents: {},\n    };\n  }\n\n  const blockingElements = (e.craft && e.craft.blockedEvents[eventName]) || [];\n\n  for (let i = 0; i < blockingElements.length; i++) {\n    const blockingElement = blockingElements[i];\n\n    if (el !== blockingElement && el.contains(blockingElement)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import { ConnectorRegistry } from './ConnectorRegistry';\nimport {\n  EventHandlerUpdates,\n  CraftEventListener,\n  EventHandlerConnectors,\n  CraftDOMEvent,\n  Connector,\n  ConnectorsUsage,\n  RegisteredConnector,\n} from './interfaces';\nimport { isEventBlockedByDescendant } from './isEventBlockedByDescendant';\n\nexport abstract class EventHandlers<O extends Record<string, any> = {}> {\n  options: O;\n\n  private registry: ConnectorRegistry = new ConnectorRegistry();\n  private subscribers: Set<(msg: EventHandlerUpdates) => void> = new Set();\n\n  onEnable?(): void;\n  onDisable?(): void;\n\n  constructor(options?: O) {\n    this.options = options;\n  }\n\n  listen(cb: (msg: EventHandlerUpdates) => void) {\n    this.subscribers.add(cb);\n    return () => this.subscribers.delete(cb);\n  }\n\n  disable() {\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this.registry.disable();\n\n    this.subscribers.forEach((listener) => {\n      listener(EventHandlerUpdates.HandlerDisabled);\n    });\n  }\n\n  enable() {\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this.registry.enable();\n\n    this.subscribers.forEach((listener) => {\n      listener(EventHandlerUpdates.HandlerEnabled);\n    });\n  }\n\n  cleanup() {\n    this.disable();\n    this.subscribers.clear();\n    this.registry.clear();\n  }\n\n  addCraftEventListener<K extends keyof HTMLElementEventMap>(\n    el: HTMLElement,\n    eventName: K,\n    listener: CraftEventListener<K>,\n    options?: boolean | AddEventListenerOptions\n  ) {\n    const bindedListener = (e: CraftDOMEvent<HTMLElementEventMap[K]>) => {\n      if (!isEventBlockedByDescendant(e, eventName, el)) {\n        e.craft.stopPropagation = () => {\n          if (!e.craft.blockedEvents[eventName]) {\n            e.craft.blockedEvents[eventName] = [];\n          }\n\n          e.craft.blockedEvents[eventName].push(el);\n        };\n\n        listener(e);\n      }\n    };\n\n    el.addEventListener(eventName, bindedListener, options);\n\n    return () => el.removeEventListener(eventName, bindedListener, options);\n  }\n\n  // Defines the connectors and their logic\n  abstract handlers(): Record<string, (el: HTMLElement, ...args: any[]) => any>;\n\n  /**\n   * Creates a record of chainable connectors and tracks their usages\n   */\n  createConnectorsUsage(): ConnectorsUsage<this> {\n    const handlers = this.handlers();\n\n    // Track all active connector ids here\n    // This is so we can return a cleanup method below so the callee can programmatically cleanup all connectors\n\n    const activeConnectorIds: Set<string> = new Set();\n\n    let canRegisterConnectors = false;\n    const connectorsToRegister: Map<\n      string,\n      () => RegisteredConnector\n    > = new Map();\n\n    const connectors = Object.entries(handlers).reduce<\n      Record<string, Connector>\n    >(\n      (accum, [name, handler]) => ({\n        ...accum,\n        [name]: (el, required, options) => {\n          const registerConnector = () => {\n            const connector = this.registry.register(el, {\n              required,\n              name,\n              options,\n              connector: handler,\n            });\n\n            activeConnectorIds.add(connector.id);\n            return connector;\n          };\n\n          connectorsToRegister.set(\n            this.registry.getConnectorId(el, name),\n            registerConnector\n          );\n\n          /**\n           * If register() has been called,\n           * register the connector immediately.\n           *\n           * Otherwise, registration is deferred until after register() is called\n           */\n          if (canRegisterConnectors) {\n            registerConnector();\n          }\n\n          return el;\n        },\n      }),\n      {}\n    ) as any;\n\n    return {\n      connectors,\n      register: () => {\n        canRegisterConnectors = true;\n\n        connectorsToRegister.forEach((registerConnector) => {\n          registerConnector();\n        });\n      },\n      cleanup: () => {\n        canRegisterConnectors = false;\n\n        activeConnectorIds.forEach((connectorId) =>\n          this.registry.remove(connectorId)\n        );\n      },\n    };\n  }\n\n  derive<C extends EventHandlers>(\n    type: {\n      new (...args: any[]): C;\n    },\n    opts: C['options']\n  ) {\n    return new type(this, opts);\n  }\n\n  // This method allows us to execute multiple connectors and returns a single cleanup method for all of them\n  protected createProxyHandlers<H extends EventHandlers>(\n    instance: H,\n    cb: (connectors: EventHandlerConnectors<H>) => void\n  ) {\n    const connectorsToCleanup = [];\n    const handlers = instance.handlers();\n\n    const proxiedHandlers = new Proxy(handlers, {\n      get: (target, key: any, receiver) => {\n        if (key in handlers === false) {\n          return Reflect.get(target, key, receiver);\n        }\n\n        return (el, ...args) => {\n          const cleanup = handlers[key](el, ...args);\n          if (!cleanup) {\n            return;\n          }\n\n          connectorsToCleanup.push(cleanup);\n        };\n      },\n    });\n\n    cb(proxiedHandlers as any);\n\n    return () => {\n      connectorsToCleanup.forEach((cleanup) => {\n        cleanup();\n      });\n    };\n  }\n\n  // This lets us to execute and cleanup sibling connectors\n  reflect(cb: (connectors: EventHandlerConnectors<this>) => void) {\n    return this.createProxyHandlers(this, cb);\n  }\n}\n","import { EventHandlers } from './EventHandlers';\nimport { EventHandlerConnectors, EventHandlerUpdates } from './interfaces';\n\n// Creates EventHandlers that depends on another EventHandlers instance\n// This lets us to easily create new connectors that composites of the parent EventHandlers instance\nexport abstract class DerivedEventHandlers<\n  P extends EventHandlers,\n  O extends Record<string, any> = {}\n> extends EventHandlers<O> {\n  derived: P;\n  unsubscribeParentHandlerListener: () => void;\n\n  constructor(derived: P, options?: O) {\n    super(options);\n    this.derived = derived;\n    this.options = options;\n\n    // Automatically disable/enable depending on the parent handlers\n    this.unsubscribeParentHandlerListener = this.derived.listen((msg) => {\n      switch (msg) {\n        case EventHandlerUpdates.HandlerEnabled: {\n          return this.enable();\n        }\n        case EventHandlerUpdates.HandlerDisabled: {\n          return this.disable();\n        }\n        default: {\n          return;\n        }\n      }\n    });\n  }\n\n  // A method to easily inherit parent connectors\n  inherit(cb: (connectors: EventHandlerConnectors<P>) => void) {\n    return this.createProxyHandlers(this.derived, cb);\n  }\n\n  cleanup() {\n    super.cleanup();\n    this.unsubscribeParentHandlerListener();\n  }\n}\n","// https://github.com/react-dnd/react-dnd\nimport { isValidElement, ReactElement } from 'react';\nimport { cloneElement } from 'react';\nimport invariant from 'tiny-invariant';\n\nimport { ChainableConnectors, ConnectorsRecord } from './interfaces';\n\nfunction setRef(ref: any, node: any) {\n  if (node) {\n    if (typeof ref === 'function') {\n      ref(node);\n    } else {\n      ref.current = node;\n    }\n  }\n}\n\nexport function cloneWithRef(\n  element: any,\n  newRef: any\n): React.ReactElement<any> {\n  const previousRef = element.ref;\n  invariant(\n    typeof previousRef !== 'string',\n    'Cannot connect to an element with an existing string ref. ' +\n      'Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. ' +\n      'Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute'\n  );\n\n  if (!previousRef) {\n    // When there is no ref on the element, use the new ref directly\n    return cloneElement(element, {\n      ref: newRef,\n    });\n  } else {\n    return cloneElement(element, {\n      ref: (node: any) => {\n        setRef(previousRef, node);\n        setRef(newRef, node);\n      },\n    });\n  }\n}\n\nfunction throwIfCompositeComponentElement(element: React.ReactElement<any>) {\n  if (typeof element.type === 'string') {\n    return;\n  }\n\n  throw new Error();\n}\n\nexport function wrapHookToRecognizeElement(\n  hook: (node: any, ...args: any[]) => void\n) {\n  return (elementOrNode = null, ...args: any) => {\n    // When passed a node, call the hook straight away.\n    if (!isValidElement(elementOrNode)) {\n      if (!elementOrNode) {\n        return;\n      }\n\n      const node = elementOrNode;\n      node && hook(node, ...args);\n      return node;\n    }\n\n    // If passed a ReactElement, clone it and attach this function as a ref.\n    // This helps us achieve a neat API where user doesn't even know that refs\n    // are being used under the hood.\n    const element: ReactElement | null = elementOrNode;\n    throwIfCompositeComponentElement(element as any);\n\n    return cloneWithRef(element, hook);\n  };\n}\n\n// A React wrapper for our connectors\n// Wrap all our connectors so that would additionally accept React.ReactElement\nexport function wrapConnectorHooks<H extends ConnectorsRecord>(\n  connectors: H\n): ChainableConnectors<H, React.ReactElement | HTMLElement> {\n  return Object.keys(connectors).reduce((accum, key) => {\n    accum[key] = wrapHookToRecognizeElement((...args) => {\n      // @ts-ignore\n      return connectors[key](...args);\n    });\n\n    return accum;\n  }, {}) as any;\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\ntype RenderIndicatorProps = {\n  style: React.CSSProperties;\n  className?: string;\n  parentDom?: HTMLElement;\n};\n\nexport const RenderIndicator = ({\n  style,\n  className,\n  parentDom,\n}: RenderIndicatorProps) => {\n  const indicator = (\n    <div\n      className={className}\n      style={{\n        position: 'fixed',\n        display: 'block',\n        opacity: 1,\n        borderStyle: 'solid',\n        borderWidth: '1px',\n        borderColor: 'transparent',\n        zIndex: 99999,\n        ...style,\n      }}\n    ></div>\n  );\n\n  if (parentDom && parentDom.ownerDocument !== document) {\n    return ReactDOM.createPortal(indicator, parentDom.ownerDocument.body);\n  }\n\n  return indicator;\n};\n","import { useEffect } from 'react';\n\nexport const useEffectOnce = (effect: () => void) => {\n  /* eslint-disable-next-line react-hooks/exhaustive-deps */\n  useEffect(effect, []);\n};\n","type DeprecationPayload = Partial<{\n  suggest: string;\n  doc: string;\n}>;\n\nexport const deprecationWarning = (name, payload?: DeprecationPayload) => {\n  let message = `Deprecation warning: ${name} will be deprecated in future relases.`;\n\n  const { suggest, doc } = payload;\n\n  if (suggest) {\n    message += ` Please use ${suggest} instead.`;\n  }\n\n  // URL link to Documentation\n  if (doc) {\n    message += `(${doc})`;\n  }\n\n  // eslint-disable-next-line no-console\n  console.warn(message);\n};\n","export const isClientSide = () => typeof window !== 'undefined';\n\nexport const isLinux = () =>\n  isClientSide() && /Linux/i.test(window.navigator.userAgent);\n\nexport const isChromium = () =>\n  isClientSide() && /Chrome/i.test(window.navigator.userAgent);\n"],"names":["ROOT_NODE","DEPRECATED_ROOT_NODE","ERROR_NOPARENT","ERROR_DUPLICATE_NODEID","ERROR_INVALID_NODEID","ERROR_TOP_LEVEL_ELEMENT_NO_ID","ERROR_MISSING_PLACEHOLDER_PLACEMENT","ERROR_MOVE_CANNOT_DROP","ERROR_MOVE_INCOMING_PARENT","ERROR_MOVE_OUTGOING_PARENT","ERROR_MOVE_NONCANVAS_CHILD","ERROR_MOVE_TO_NONCANVAS_PARENT","ERROR_MOVE_TOP_LEVEL_NODE","ERROR_MOVE_ROOT_NODE","ERROR_MOVE_TO_DESCENDANT","ERROR_NOT_IN_RESOLVER","ERROR_INFINITE_CANVAS","ERROR_CANNOT_DRAG","ERROR_INVALID_NODE_ID","ERROR_DELETE_TOP_LEVEL_NODE","ERROR_RESOLVER_NOT_AN_OBJECT","ERROR_DESERIALIZE_COMPONENT_NOT_IN_RESOLVER","ERROR_USE_EDITOR_OUTSIDE_OF_EDITOR_CONTEXT","ERROR_USE_NODE_OUTSIDE_OF_EDITOR_CONTEXT","HISTORY_ACTIONS","UNDO","REDO","THROTTLE","IGNORE","MERGE","CLEAR","History","constructor","_defineProperty","add","patches","inversePatches","length","pointer","timeline","timestamp","Date","now","throttleAdd","throttleRate","currPatches","currInversePatches","diff","getTime","merge","clear","canUndo","canRedo","undo","state","applyPatches","redo","enableMapSet","enablePatches","useMethods","methodsOrOptions","initialState","queryMethods","patchListener","history","useMemo","methodsFactory","ignoreHistoryForActionsRef","useRef","normalizeHistoryRef","methods","current","ignoreHistoryForActions","normalizeHistory","patchListenerRef","stateRef","reducer","action","query","createQuery","finalState","nextState","produceWithPatches","draft","type","_objectSpread","params","payload","cb","normalizedDraft","includes","produce","config","rate","getState","useCallback","watcher","Watcher","dispatch","newState","notify","useEffect","actions","actionTypes","Object","keys","reduce","accum","_len","arguments","Array","_key","throttle","filter","_len2","_key2","ignore","_len3","_key3","_len4","_key4","subscribe","collector","collectOnCreate","queries","key","onChange","subscriber","Subscriber","subscribers","push","unsubscribe","bind","index","indexOf","splice","forEach","collect","undefined","recollect","isEqualWith","collected","err","console","warn","getDOMInfo","el","x","y","top","left","bottom","right","width","height","getBoundingClientRect","style","window","getComputedStyle","margin","parseInt","marginLeft","marginRight","marginBottom","marginTop","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","styleInFlow","parent","parentStyle","overflow","float","display","position","tagName","outerWidth","Math","round","outerHeight","inFlow","parentElement","getRandomId","size","nanoid","ConnectorRegistry","WeakMap","Map","getElementId","element","existingId","elementIdMap","get","newId","set","getConnectorId","connectorName","elementId","concat","register","connectorPayload","existingConnector","getByElement","name","isEqual","required","disable","cleanup","id","registry","enable","connector","options","remove","isEnabled","delete","connectors","removeByElement","EventHandlerUpdates","isEventBlockedByDescendant","e","eventName","craft","stopPropagation","blockedEvents","blockingElements","i","blockingElement","contains","EventHandlers","Set","listen","onDisable","listener","HandlerDisabled","onEnable","HandlerEnabled","addCraftEventListener","bindedListener","addEventListener","removeEventListener","createConnectorsUsage","handlers","activeConnectorIds","canRegisterConnectors","connectorsToRegister","entries","_ref","handler","registerConnector","connectorId","derive","opts","createProxyHandlers","instance","connectorsToCleanup","proxiedHandlers","Proxy","target","receiver","Reflect","args","reflect","DerivedEventHandlers","derived","unsubscribeParentHandlerListener","msg","inherit","deprecationWarning","message","suggest","doc","isClientSide","isLinux","test","navigator","userAgent","isChromium"],"mappings":"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"}